{"uid":"b547dd4c249dbb75","name":"Проверка создания билда UI","fullName":"tests.frontend.test_e2e_build#test_create_build","historyId":"f6d35de50766f8bedac74cae9459e2eb","time":{"start":1712518054033,"stop":1712518058709,"duration":4676},"description":"Тест проверяет создание нового билда через UI","descriptionHtml":"<p>Тест проверяет создание нового билда через UI</p>\n","status":"broken","statusMessage":"ValueError: Unexpexted status-code: 400","statusTrace":"browser = <Page url='http://localhost:8111/favorite/projects'>\nproject_data_body = <function project_data_body.<locals>._create_project_data at 0x7fe46820b130>\nsuper_admin = <entities.user.User object at 0x7fe469777c70>\n\n    @allure.feature('Управление билдами')\n    @allure.story('Создание билда UI')\n    @allure.severity(allure.severity_level.CRITICAL)\n    @allure.link('https://example.com/docs/create_project', name='Документация')\n    @allure.issue('https://issue.tracker/project/123', name='Баг-трекер')\n    @allure.testcase('https://testcase.manager/testcase/456', name='Тест-кейс')\n    @allure.title('Проверка создания билда UI')\n    @allure.description('Тест проверяет создание нового билда через UI')\n    @pytest.mark.teardown_required\n    def test_create_build(browser, project_data_body, super_admin):\n        with allure.step(\"Подготовка данных\"):\n            project_data = project_data_body()\n            build_data = BuildData.create_build_data(project_data.id)\n            build_name = build_data.name\n            build_id = build_data.id\n    \n        with allure.step(\"Авторизация пользователя\"):\n            login_browser = LoginPage(browser)\n            login_browser.login(AdminCreds.USERNAME, AdminCreds.PASSWORD)\n    \n        with allure.step('Создание проекта'):\n>           super_admin.api_object.project_api.create_project(project_data.model_dump())\n\ntests/frontend/test_e2e_build.py:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \napi/project_api.py:9: in create_project\n    return self.send_request(\"POST\", \"/app/rest/projects\", data=project_data, expected_status_code=expected_status)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <api.project_api.ProjectAPI object at 0x7fe469777910>, method = 'POST'\nendpoint = '/app/rest/projects'\ndata = {'copyAllAssociatedSettings': True, 'id': 'c6mCKhe8b43', 'name': 'skill', 'parentProject': {'locator': '_Root'}}\nexpected_status_code = <HTTPStatus.OK: 200>, need_logging = True\n\n    def send_request(self, method, endpoint, data=None, expected_status_code=HTTPStatus.OK, need_logging=True):\n        \"\"\"\n        Wrapper для запросов. Позволяет прикручивать дополнительную логику.\n        :param method: Метод запроса\n        :param endpoint: Endpoint для склейки с base_url\n        :param data: Тело запроса\n        :param expected_status: Ожидаемый статус-код\n        :return: Возвращает обхект ответа\n        \"\"\"\n        url = f\"{self.base_url}{endpoint}\"\n        response = self.session.request(method, url, json=data)\n        if need_logging:\n            self.log_request_and_response(response)\n        if response.status_code != expected_status_code:\n>           raise ValueError(f\"Unexpexted status-code: {response.status_code}\")\nE           ValueError: Unexpexted status-code: 400\n\ncustom_requester/custom_requester.py:29: ValueError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1712517959758,"stop":1712517959780,"duration":22},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"delay_between_tests","time":{"start":1712518048500,"stop":1712518053500,"duration":5000},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"browser","time":{"start":1712518053500,"stop":1712518054024,"duration":524},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"super_admin","time":{"start":1712518054024,"stop":1712518054033,"duration":9},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"user_session","time":{"start":1712518054024,"stop":1712518054024,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"project_data_body","time":{"start":1712518054033,"stop":1712518054033,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"testStage":{"description":"Тест проверяет создание нового билда через UI","status":"broken","statusMessage":"ValueError: Unexpexted status-code: 400","statusTrace":"browser = <Page url='http://localhost:8111/favorite/projects'>\nproject_data_body = <function project_data_body.<locals>._create_project_data at 0x7fe46820b130>\nsuper_admin = <entities.user.User object at 0x7fe469777c70>\n\n    @allure.feature('Управление билдами')\n    @allure.story('Создание билда UI')\n    @allure.severity(allure.severity_level.CRITICAL)\n    @allure.link('https://example.com/docs/create_project', name='Документация')\n    @allure.issue('https://issue.tracker/project/123', name='Баг-трекер')\n    @allure.testcase('https://testcase.manager/testcase/456', name='Тест-кейс')\n    @allure.title('Проверка создания билда UI')\n    @allure.description('Тест проверяет создание нового билда через UI')\n    @pytest.mark.teardown_required\n    def test_create_build(browser, project_data_body, super_admin):\n        with allure.step(\"Подготовка данных\"):\n            project_data = project_data_body()\n            build_data = BuildData.create_build_data(project_data.id)\n            build_name = build_data.name\n            build_id = build_data.id\n    \n        with allure.step(\"Авторизация пользователя\"):\n            login_browser = LoginPage(browser)\n            login_browser.login(AdminCreds.USERNAME, AdminCreds.PASSWORD)\n    \n        with allure.step('Создание проекта'):\n>           super_admin.api_object.project_api.create_project(project_data.model_dump())\n\ntests/frontend/test_e2e_build.py:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \napi/project_api.py:9: in create_project\n    return self.send_request(\"POST\", \"/app/rest/projects\", data=project_data, expected_status_code=expected_status)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <api.project_api.ProjectAPI object at 0x7fe469777910>, method = 'POST'\nendpoint = '/app/rest/projects'\ndata = {'copyAllAssociatedSettings': True, 'id': 'c6mCKhe8b43', 'name': 'skill', 'parentProject': {'locator': '_Root'}}\nexpected_status_code = <HTTPStatus.OK: 200>, need_logging = True\n\n    def send_request(self, method, endpoint, data=None, expected_status_code=HTTPStatus.OK, need_logging=True):\n        \"\"\"\n        Wrapper для запросов. Позволяет прикручивать дополнительную логику.\n        :param method: Метод запроса\n        :param endpoint: Endpoint для склейки с base_url\n        :param data: Тело запроса\n        :param expected_status: Ожидаемый статус-код\n        :return: Возвращает обхект ответа\n        \"\"\"\n        url = f\"{self.base_url}{endpoint}\"\n        response = self.session.request(method, url, json=data)\n        if need_logging:\n            self.log_request_and_response(response)\n        if response.status_code != expected_status_code:\n>           raise ValueError(f\"Unexpexted status-code: {response.status_code}\")\nE           ValueError: Unexpexted status-code: 400\n\ncustom_requester/custom_requester.py:29: ValueError","steps":[{"name":"Подготовка данных","time":{"start":1712518054034,"stop":1712518054034,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"Авторизация пользователя","time":{"start":1712518054034,"stop":1712518058693,"duration":4659},"status":"passed","steps":[{"name":"Переход на страницу авторизации","time":{"start":1712518054034,"stop":1712518055597,"duration":1563},"status":"passed","steps":[{"name":"Переход на URL: http://localhost:8111/login.html","time":{"start":1712518054034,"stop":1712518055582,"duration":1548},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"Ожидание загрузки страницы","time":{"start":1712518055582,"stop":1712518055597,"duration":15},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true},{"name":"Ввод данных для авторизации","time":{"start":1712518055598,"stop":1712518056023,"duration":425},"status":"passed","steps":[{"name":"Ввод текста 'admin' в элемент #username","time":{"start":1712518055598,"stop":1712518055705,"duration":107},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"Ввод текста 'admin' в элемент #password","time":{"start":1712518055705,"stop":1712518056023,"duration":318},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true},{"name":"Нажатие на кнопку 'Log in'","time":{"start":1712518056023,"stop":1712518056417,"duration":394},"status":"passed","steps":[{"name":"Клик по элементу: .loginButton","time":{"start":1712518056023,"stop":1712518056417,"duration":394},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Ожидание изменения URL на http://localhost:8111/favorite/projects","time":{"start":1712518056417,"stop":1712518058693,"duration":2276},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":9,"attachmentsCount":0,"hasContent":true},{"name":"Создание проекта","time":{"start":1712518058693,"stop":1712518058706,"duration":13},"status":"broken","statusMessage":"ValueError: Unexpexted status-code: 400\n","statusTrace":"  File \"/home/runner/work/TeamCity/TeamCity/tests/frontend/test_e2e_build.py\", line 34, in test_create_build\n    super_admin.api_object.project_api.create_project(project_data.model_dump())\n  File \"/home/runner/work/TeamCity/TeamCity/api/project_api.py\", line 9, in create_project\n    return self.send_request(\"POST\", \"/app/rest/projects\", data=project_data, expected_status_code=expected_status)\n  File \"/home/runner/work/TeamCity/TeamCity/custom_requester/custom_requester.py\", line 29, in send_request\n    raise ValueError(f\"Unexpexted status-code: {response.status_code}\")\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[{"uid":"bf56399f6835b88d","name":"log","source":"bf56399f6835b88d.txt","type":"text/plain","size":2336}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":12,"attachmentsCount":1,"hasContent":true},"afterStages":[{"name":"project_data_body::0","time":{"start":1712518058732,"stop":1712518058753,"duration":21},"status":"broken","statusMessage":"ValueError: Unexpexted status-code: 404\n","statusTrace":"  File \"/home/runner/.local/lib/python3.10/site-packages/allure_commons/_allure.py\", line 221, in __call__\n    return self._fixture_function(*args, **kwargs)\n  File \"/home/runner/.local/lib/python3.10/site-packages/_pytest/fixtures.py\", line 926, in _teardown_yield_fixture\n    next(it)\n  File \"/home/runner/work/TeamCity/TeamCity/conftest.py\", line 51, in project_data_body\n    super_admin.api_object.project_api.clean_up_project(project_id)\n  File \"/home/runner/work/TeamCity/TeamCity/api/project_api.py\", line 21, in clean_up_project\n    self.delete_project(created_project_id)\n  File \"/home/runner/work/TeamCity/TeamCity/api/project_api.py\", line 18, in delete_project\n    return self.send_request(\"DELETE\", f\"/app/rest/projects/id:{project_id}\", expected_status_code=expected_status)\n  File \"/home/runner/work/TeamCity/TeamCity/custom_requester/custom_requester.py\", line 29, in send_request\n    raise ValueError(f\"Unexpexted status-code: {response.status_code}\")\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true},{"name":"browser::0","time":{"start":1712518058754,"stop":1712518060038,"duration":1284},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"user_session::0","time":{"start":1712518058754,"stop":1712518058754,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"labels":[{"name":"story","value":"Создание билда UI"},{"name":"feature","value":"Управление билдами"},{"name":"severity","value":"critical"},{"name":"tag","value":"teardown_required"},{"name":"parentSuite","value":"tests.frontend"},{"name":"suite","value":"test_e2e_build"},{"name":"host","value":"fv-az736-406"},{"name":"thread","value":"9000-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.frontend.test_e2e_build"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"browser","value":"'chromium'"}],"links":[{"name":"Тест-кейс","url":"https://testcase.manager/testcase/456","type":"tms"},{"name":"Баг-трекер","url":"https://issue.tracker/project/123","type":"issue"},{"name":"Документация","url":"https://example.com/docs/create_project","type":"link"}],"hidden":true,"retry":true,"extra":{"categories":[],"tags":["teardown_required"]},"source":"b547dd4c249dbb75.json","parameterValues":["'chromium'"]}